<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="sr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

    <title>Planinarski klub "Summit Explorers"</title>

    <!-- Bootstrap 4.5 CSS -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <!-- reference CSS file -->
    <link rel="stylesheet" th:href="@{/css/myStyle.css}">

    <!--Font Awesome ikonice!-->
    <link th:href="@{/fontAwesome/all.css}" rel="stylesheet">
    <!--load all styles -->
</head>
<body class="bodyKorisnikBackground">

<!-- Top Bar -->
<div th:replace="fragments/topBar :: topBar1(brojTelefonaKluba=${klub.brojTelefona}, emailKluba=${klub.email})"></div>
<!-- kraj Top Bara -->

<!-- Navigation bar fragment -->
<div th:replace="fragments/navBar :: navBar1"></div>
<!-- Navigation bar fragment END-->


<div class="container" style="background-color: #fff;">
    <div class="col-md-12" style="height: 2rem;">

    </div>

    <div class="col-12 text-center" style="margin-bottom: 1.8rem;">
        <h2>Porudžbina</h2>
    </div>

    <div class="row justify-content-center">
        <div class="col-md-4">
            <p class="lead">Proizvodi u korpi:</p>
            <ul>
                <li th:each="stavka : ${listaStavkiKorpeKorisnika}">[[${stavka.proizvod.naziv}]] (Količina: <b>[[${stavka.izabranaKolicina}]]</b>)</li>
            </ul>
        </div>
        <div class="col-md-5">
        <form action="#" th:action="@{/korisnik/shopping-cart/nova-narudzbenica}" th:object="${novaNarudzbenica}" method="POST">
            <div class="form-group">
                <label for="adresaZaIsporuku">Adresa za Isporuku:</label>
                <input type="text" th:field="*{adresaZaIsporuku}" id="adresaZaIsporuku" placeholder="Unesite adresu za isporuku" class="form-control" required th:errorclass="fieldError">
                <ul th:if="${#fields.hasErrors('adresaZaIsporuku')}">
                    <li th:each="err : ${#fields.errors('adresaZaIsporuku')}" th:text="${err}" class="errorMsg"></li>
                </ul>
            </div>
            <div class="form-group">
                <label for="grad">Grad:</label>
                <input type="text" th:field="*{grad}" id="grad" placeholder="Unesite grad" class="form-control" required th:errorclass="fieldError">
                <ul th:if="${#fields.hasErrors('grad')}">
                    <li th:each="err : ${#fields.errors('grad')}" th:text="${err}" class="errorMsg"></li>
                </ul>
            </div>
            <div class="form-group mb-4">
                <label for="zipCode">Poštanski broj:</label>
                <input type="text" th:field="*{zipCode}" id="zipCode" placeholder="Unesite poštanski broj" class="form-control" required th:errorclass="fieldError">
                <ul th:if="${#fields.hasErrors('zipCode')}">
                    <li th:each="err : ${#fields.errors('zipCode')}" th:text="${err}" class="errorMsg"></li>
                </ul>
            </div>

            <th:block th:if="${izabranaNagrada != null}">
                <div class="col-md-12 d-flex justify-content-center align-items-center">
                    <span class="mr-4" style="font-size: 20px;">Total Cena:</span>
                    <span class="font-weight-bolder" style="font-size: 20px;">[[${totalCenaDiscounted}]]&#8364;</span>
                </div>
                <div class="col-md-12 px-4 mb-3" style="font-size: 14px;">
                    Izabrali ste da iskoristite nagradni popust od <span class="font-weight-bolder" style="color: #3c912d; font-size: 16px;">[[${izabranaNagrada.popust}]]%</span> sa bodovima sa vaše članske kartice.
                    Skinuće Vam se <span style="color: red;">[[${izabranaNagrada.vrednostBodovi}]]</span> bodova.
                </div>
            </th:block>

            <th:block th:unless="${izabranaNagrada != null}">
                <div class="col-md-12 d-flex justify-content-center align-items-center mb-3" style="font-size: 20px;">
                    <span class="mr-4">Total Cena:</span>
                    <span class="font-weight-bolder">[[${totalCenaKorpe}]]&#8364;</span>
                </div>
                <th:block th:if="${@clanskaKarticaServiceImpl.isActive(novaNarudzbenica.korisnik.clanskaKartica)}">
                    <div class="col-md-12 px-4 mb-3" style="font-size: 14px;">
                        *Za svaku novu porudžbinu na vašu karticu dodaće se <span class="font-weight-bolder" style="color: green;">1200 bodova</span>. Prikupljajte bodove
                        koje posle možete da iskoristite za dodatni popust prilikom budućih porudžbina.
                    </div>
                </th:block>
            </th:block>


            <!--Hidden polja za prenos za narudzbenicu -->
            <input type="hidden" th:field="*{narudzbenicaId}">
            <input type="hidden" th:field="*{korisnik}">
            <th:block th:if="${izabranaNagrada != null}">
                <input type="hidden" name="totalCena" th:value="${totalCenaDiscounted}">
                <input type="hidden" name="radioDiscountPackage" th:value="${izabranaNagrada.clanskaKartDiscountId}">
            </th:block>

            <th:block th:unless="${izabranaNagrada != null}">
                <input type="hidden" name="totalCena" th:value="${totalCenaKorpe}">
            </th:block>
            <!--/* datumVreme polje narudzbenice cemo postaviti u kontroller metodi za ovu formu, na isti nacin kao i datumVremeRez prilikom pravljenja rezervacije
             korisnika u rezervacijaController-u */-->

            <div class="d-flex justify-content-center">
                <input type="submit" value="Izvrši Porudžbinu" name="btnIzvrsiPorudzbinu" class="btn btn-warning mr-2" style="font-size: 18px;">
                <a class="btn btn-outline-secondary" th:href="@{/korisnik/shopping-cart}">Nazad na Korpu</a>
            </div>

        </form>
        </div>
    </div><!--KRAJ div-a FORME -->

    <div class="col-md-12" style="height: 2rem;">

    </div>

</div>



<!-- Script Source Files -->

<!-- jQuery -->
<script th:src="@{/js/jquery-3.5.1.min.js}"></script>
<!-- Popper JS -->
<script th:src="@{/js/popper.min.js}"></script>
<!-- Bootstrap 4.5 JS -->
<script th:src="@{/js/bootstrap.min.js}"></script>
<!-- Font Awesome -->
<script th:src="@{/js/all.js}"></script>
</body>
</html>